import React, { Component, Fragment } from "react";

import {
  EuiFlexGroup,
  EuiFlexItem,
  EuiButtonEmpty,
  EuiTitle,
  EuiText,
  EuiTextAlign,
  EuiSpacer,
  EuiFieldText
} from "@elastic/eui";

import { WzConfigurationSettingsHeaderViewer } from '../util-components/configuration-settings-header';
import WzConfigurationSettingsGroup from '../util-components/configuration-settings-group';
import WzViewSelector from '../util-components/view-selector';
import { WzSettingsViewer } from '../util-components/code-viewer';
import WzConfigurationSettingsTabSelector from '../util-components/configuration-settings-tab-selector';

const helpLinks = [
  { text: 'Global reference', href: 'https://documentation.wazuh.com/current/user-manual/reference/ossec-conf/global.html' },
  { text: 'Logging reference', href: 'https://documentation.wazuh.com/current/user-manual/reference/ossec-conf/logging.html' }
];

const mainSettings = [
  { field: 'alerts_log', label: 'Write alerts to alerts.log file'},
  { field: 'jsonout_output', label: 'Write JSON formatted alerts to alerts.json file' },
  { field: 'logall', label: 'Archive all the alerts in plain text format' },
  { field: 'logall_json', label: 'Archive all the alerts in JSON format' },
  { field: 'plain', label: 'Write internal logs in plain text' },
  { field: 'json', label: 'Write internal logs in JSON format' },
  { field: 'max_output_size', label: 'Size limit of alert files' },
  { field: 'rotate_interval', label: 'File rotation interval' }
];

const emailSettings = [
  { field: 'email_notification', label: 'Enable alerts sent by email'}
];

const otherSettings = [
  { field: 'stats', label: 'Severity level for alerts generated by statistical analysis'},
  { field: 'host_information', label: 'Severity level for alerts generated by host change monitor'},
  { field: 'memory_size', label: 'Memory size for the alert correlation engine'},
  { field: 'white_list', label: 'White-listed IP addresses'}
];

const preludeZeroMQOutputSettings = [
  { field: 'prelude_output', label: 'Enable Prelude output'},
  { field: 'zeromq_output', label: 'Enable ZeroMQ output'}
];

class WzConfigurationGlobalConfigurationGlobal extends Component{
  constructor(props){
    super(props);
  }
  render(){
    const { currentConfig } = this.props;
    const mainSettingsConfig = {
      ...currentConfig['analysis-global'].global,
      plain: currentConfig['com-logging'].logging.plain,
      json: currentConfig['com-logging'].logging.json,
    };
    const globalSettingsConfig = {
      ...currentConfig['analysis-global'].global
    };
    // TODO: Missing field for rendering? Juanca?
    return (
      <WzConfigurationSettingsTabSelector title='Main settings' description='Basic alerts and logging settings' currentConfig={currentConfig} helpLinks={helpLinks}>
        <WzConfigurationSettingsGroup
          config={mainSettingsConfig}
          items={mainSettings}
        />
        <WzConfigurationSettingsGroup
          title='Email settings'
          description='Basic email settings (needed for granular email settings)'
          config={globalSettingsConfig}
          items={emailSettings}/>
        <WzConfigurationSettingsGroup
          title='Other settings'
          description='Settings not directly related to any specific component'
          config={globalSettingsConfig}
          items={otherSettings}/>
        <WzConfigurationSettingsGroup
          title='Prelude and ZeroMQ output'
          config={globalSettingsConfig}
          items={preludeZeroMQOutputSettings}/>
      </WzConfigurationSettingsTabSelector>
    )
  }
}

export default WzConfigurationGlobalConfigurationGlobal;